var playable=function(){let playable={Position:{above:"above",below:"below",left:"left",right:"right",center:"center",centerX:"centerX",centerY:"centerY"},context:{}};return Object.defineProperty(createjs.DisplayObject.prototype,"frame",{get:function(){let bounds=this.getBounds();return{x:this.x-this.regX,y:this.y-this.regY,width:bounds.width,height:bounds.height}}}),Object.defineProperty(createjs.DisplayObject.prototype,"origin",{get:function(){return{x:this.x-this.regX,y:this.y-this.regY}},set:function(newValue){this.x=newValue.x+this.regX,this.y=newValue.y+this.regY}}),createjs.DisplayObject.prototype.positionRelativeTo=function(other,direction,spacing){let thisFrame=this.frame,otherFrame=other.frame;void 0===spacing&&(spacing=0);let newOrigin={x:0,y:0};switch(direction){case playable.Position.above:newOrigin={x:thisFrame.x,y:otherFrame.y-thisFrame.height-spacing};break;case playable.Position.below:newOrigin={x:thisFrame.x,y:otherFrame.y+otherFrame.height+spacing};break;case playable.Position.left:newOrigin={x:otherFrame.x-thisFrame.width-spacing,y:thisFrame.y};break;case playable.Position.right:newOrigin={x:otherFrame.x+spacing,y:thisFrame.y};break;case playable.Position.center:newOrigin={x:otherFrame.x+.5*otherFrame.width-.5*thisFrame.width,y:otherFrame.y+.5*otherFrame.height-.5*thisFrame.height};break;case playable.Position.centerX:newOrigin={x:otherFrame.x+.5*otherFrame.width-.5*thisFrame.width+spacing,y:thisFrame.y};break;case playable.Position.centerY:newOrigin={x:thisFrame.x,y:otherFrame.y+.5*otherFrame.height-.5*thisFrame.height+spacing}}return newOrigin},createjs.DisplayObject.prototype.setPositionRelativeTo=function(other,direction,spacing){this.origin=this.positionRelativeTo(other,direction,spacing)},playable.Preloader=function(){this.loaded={}},playable.Preloader.shared=null,playable.Preloader.prototype.loadImage=function(id,url){return new Promise(resolve=>{let listener,image=new Image;listener=image.addEventListener("load",()=>{image.removeEventListener("load",listener),this.loaded[id]=image,resolve(image)}),image.src=url})},playable.Preloader.prototype.loadManifest=function(manifest){let promises=manifest.map(item=>this.loadImage(item.id,item.src));return Promise.all(promises)},playable.Preloader.prototype.getResult=function(id){return this.loaded[id]},playable.dimensions=((scene,sceneName,event)=>{let requirements=playable.SceneConfiguration[sceneName].require,relocater=playable.SceneConfiguration[sceneName].relocate[event];return requirements.forEach(r=>{if(!Object.keys(scene).includes(r))throw new Error("Error: missing required asset "+r+" in "+sceneName+"."+event)}),relocater.call(scene)}),playable}();try{void 0!==module.exports&&(module.exports=playable)}catch(e){}try{if(void 0!==module.exports)playable=require("./playable")}catch(e){}!function(){const p=playable,canvasDimensions_width=320,canvasDimensions_height=480;document.addEventListener("DOMContentLoaded",event=>{const canvas=document.getElementById("playable-canvas");canvas&&(canvas.setAttribute("width",canvasDimensions_width),canvas.setAttribute("height",canvasDimensions_height))}),playable.SceneConfiguration={shared:{},FirstScene:{require:["stage","sample"],relocate:{setup:function(){this.stage.setBounds(0,0,canvasDimensions_width,canvasDimensions_height),this.sample.setPositionRelativeTo(this.stage,p.Position.centerX),this.sample.setPositionRelativeTo(this.stage,p.Position.centerY)}}},SecondScene:{require:["stage"],relocate:{setup:function(){}}}}}();try{if(void 0!==module.exports)playable=require("./playable")}catch(e){}playable.play=function(completion){playable.Preloader.shared=new playable.Preloader;let stage=new createjs.Stage("playable-canvas");this.story=new playable.Story(stage,completion);let scenes=[new playable.context.FirstScene(stage,playable.SceneConfiguration.shared,this.story),new playable.context.SecondScene(stage,playable.SceneConfiguration.shared,this.story)];this.story.tell(void 0,scenes)},playable.playScenes=function({scenes:scenes,canvasID:canvasID="playable-canvas",completion:completion=null,background:background,preloader:preloader}){let stage=new createjs.Stage(canvasID),story=new playable.Story(stage,completion,preloader);return story.tell(background,scenes),story};try{if(void 0!==module.exports)playable=require("./playable")}catch(e){}!function(){function Scene(stage,config,delegate){this.stage=stage,this.config=config,this.delegate=delegate}Object.defineProperty(Scene.prototype,"preloadManifest",{get:()=>[]}),Scene.prototype.setup=function(props){},Scene.prototype.tearDown=function(){return new Promise((resolve,reject)=>resolve({}))},Scene.prototype.checkIntersection=function(rect1,rect2){return!(rect1.x>=rect2.x+rect2.width||rect1.x+rect1.width<=rect2.x||rect1.y>=rect2.y+rect2.height||rect1.y+rect1.height<=rect2.y)},playable.Scene=Scene}();try{if(void 0!==module.exports)playable=require("./playable")}catch(e){}!function(){function Story(stage,completion,preloader){this.completion=completion,this.stage=stage,this.isWaitingForPreloadToAdvanceScene=!1,this.preloader=preloader||playable.Preloader.shared}Story.prototype.setBackground=function(image){if(this.background&&this.stage.removeChild(this.background),!image)return;this.background=new createjs.Bitmap(image);let hitArea=new createjs.Shape;hitArea.graphics.beginFill("#000").drawRect(0,0,320,480),this.background.hitArea=hitArea,this.stage.addChildAt(this.background,0)},Story.prototype.tell=function(background,scenes){this.setBackground(background),this.stage.update(),createjs.Ticker.framerate=60,createjs.Ticker.addEventListener("tick",this.stage),this.scenes=scenes,this.preloadedScenes=[],this.currentScene=null,this.preloadScene(this.scenes[0]).then(()=>this.advanceSceneWhenReady())},Story.prototype.preloadScene=function(scene){let manifest=scene.preloadManifest;return manifest.length?this.preloader.loadManifest(manifest).then(()=>(this.preloadedScenes.push(scene),scene)):(this.preloadedScenes.push(scene),new Promise((resolve,reject)=>resolve(scene)))},Story.prototype.advanceSceneWhenReady=function(){let currentSceneIndex=null!==this.currentScene?this.scenes.indexOf(this.currentScene):null,nextSceneIndex=null!==currentSceneIndex?currentSceneIndex+1:0;if(nextSceneIndex===this.scenes.length)return void this.completion();let nextScene=this.scenes[nextSceneIndex];-1!==this.preloadedScenes.indexOf(nextScene)?null!==this.currentScene?this.currentScene.tearDown().then(props=>this.advanceScene(nextScene,props)):this.advanceScene(nextScene,{}):this.isWaitingForPreloadToAdvanceScene=!0},Story.prototype.advanceScene=function(nextScene,props){nextScene.setup(props),this.currentScene=nextScene;let followingSceneIndex=this.scenes.indexOf(nextScene)+1;followingSceneIndex<this.scenes.length&&this.preloadScene(this.scenes[followingSceneIndex]).then(()=>{this.isWaitingForPreloadToAdvanceScene&&(this.isWaitingForPreloadToAdvanceScene=!1,this.advanceSceneWhenReady())})},Story.prototype.sceneDelegateSceneShouldEnd=function(scene){scene===this.currentScene&&this.advanceSceneWhenReady()},Story.prototype.sceneDelegateStoryShouldEnd=function(scene){this.completion()},playable.Story=Story}(),function(){function FirstScene(stage,config,delegate){playable.Scene.apply(this,arguments)}function SecondScene(stage,config,delegate){playable.Scene.apply(this,arguments)}FirstScene.prototype=Object.create(playable.Scene.prototype),FirstScene.prototype.constructor=FirstScene,Object.defineProperty(FirstScene.prototype,"preloadManifest",{get:()=>[{id:"Sample",src:"sample.png"}]}),FirstScene.prototype.setup=function(props){this.sample=new createjs.Bitmap(this.delegate.preloader.getResult("Sample")),this.stage.addChild(this.sample),this.sample.alpha=0,this.sample.on("click",()=>{this.delegate.sceneDelegateSceneShouldEnd(this)});let timeline=new createjs.Timeline;(shape=>timeline.addTween(createjs.Tween.get(shape).to({alpha:1},1e3,createjs.Ease.getPowInOut(4))))(this.sample);createjs.Tween.get(this.sample,{loop:8}).to({y:this.sample.y+10},200).wait(100).to({y:this.sample.y-10},200),this.checkForInteractionTimeout=setTimeout(()=>{this.delegate.sceneDelegateSceneShouldEnd(this)},1e4),playable.dimensions(this,"FirstScene","setup")},FirstScene.prototype.tearDown=function(){return clearTimeout(this.checkForInteractionTimeout),this.sample.off("click"),new Promise(resolve=>{let timeline=new createjs.Timeline({onComplete:()=>{resolve({sample:this.sample})}});(shape=>timeline.addTween(createjs.Tween.get(shape).to({scaleX:1.5,scaleY:1.5},1e3,createjs.Ease.getPowInOut(4))))(this.sample)})},SecondScene.prototype=Object.create(playable.Scene.prototype),SecondScene.prototype.constructor=SecondScene,Object.defineProperty(SecondScene.prototype,"preloadManifest",{get:()=>[]}),SecondScene.prototype.setup=function(props){this.sample=props.sample,this.sample.on("click",()=>this.delegate.sceneDelegateStoryShouldEnd(this)),playable.dimensions(this,"SecondScene","setup")},SecondScene.prototype.tearDown=function(){return new Promise.resolve({})},playable.context.FirstScene=FirstScene,playable.context.SecondScene=SecondScene}();